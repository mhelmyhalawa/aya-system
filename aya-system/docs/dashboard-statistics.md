# مكون إحصائيات لوحة التحكم (Dashboard Statistics)

## نظرة عامة

يوفر مكون `DashboardStatistics` إحصائيات عامة وخاصة لمستخدمي النظام حسب أدوارهم. يعرض المكون البيانات الإحصائية في بطاقات سهلة القراءة مع أيقونات توضيحية.

## المزايا الرئيسية

- **إحصائيات عامة**: عدد الحلقات، عدد الطلاب، عدد المعلمين، عدد الغياب اليومي
- **إحصائيات خاصة بالمستخدم**: بيانات مخصصة حسب دور المستخدم (مدير، مشرف، معلم)
- **بيانات مفصلة**: جداول لآخر سجلات الحفظ والتقييمات للمعلمين
- **معلومات للزوار**: الحلقات المتاحة للتسجيل ومواعيد الجلسات

## الاستخدام

```tsx
// استيراد المكون
import { DashboardStatistics } from "@/components/pages/dashboard-statistics";

// استخدام المكون في الصفحة
<DashboardStatistics userRole={user.role} userId={user.id} />
```

## كيفية التكامل مع التطبيق

### 1. استخدام مكون `Dashboard` الجاهز

الطريقة الأسهل هي استخدام مكون `Dashboard` الذي يتضمن مكون الإحصائيات مع تنسيق جاهز:

```tsx
// في أي صفحة من صفحات التطبيق
import { Dashboard } from '@/components/pages/dashboard';

function HomePage() {
  // معلومات المستخدم يمكن الحصول عليها من سياق التطبيق
  const userRole = "teacher"; // أو "admin" أو "superadmin"
  const userId = "user-123";
  
  return (
    <div>
      {/* مكونات أخرى */}
      <Dashboard userRole={userRole} userId={userId} />
      {/* مكونات أخرى */}
    </div>
  );
}
```

### 2. دمج المكون مباشرة في صفحة موجودة

يمكنك دمج مكون `DashboardStatistics` مباشرة في أي صفحة:

```tsx
import { DashboardStatistics } from '@/components/pages/dashboard-statistics';
import { Card } from '@/components/ui/card';

function ExistingPage({ userRole, userId }) {
  return (
    <div className="container mx-auto">
      <h2 className="text-2xl font-bold mb-4 text-islamic-green">لوحة الإحصائيات</h2>
      
      <Card className="border-islamic-green/30 p-6 shadow-md mb-8">
        <DashboardStatistics userRole={userRole} userId={userId} />
      </Card>
    </div>
  );
}
```

## الخصائص (Props)

| الخاصية | النوع | الوصف |
|---------|------|-------|
| `userRole` | `UserRole \| null` | دور المستخدم (admin, teacher, superadmin, null) |
| `userId` | `string \| null` | معرف المستخدم (مطلوب للإحصائيات الخاصة) |

## الإحصائيات حسب نوع المستخدم

### 1. مدير النظام (superadmin)
- يرى الإحصائيات العامة للنظام بالكامل
- عدد الحلقات الإجمالي
- عدد الطلاب الإجمالي
- عدد المعلمين الإجمالي
- عدد الغياب اليومي الإجمالي

### 2. المشرف (admin)
- يرى الإحصائيات العامة للنظام
- عدد الحلقات تحت إشرافه
- عدد المعلمين تحت إشرافه
- عدد الطلاب في الحلقات تحت إشرافه

### 3. المعلم (teacher)
- عدد الحلقات التي يدرسها
- عدد الطلاب في حلقاته
- عدد الغياب في حلقاته اليوم
- آخر سجلات الحفظ لطلابه
- آخر تقييمات لطلابه

### 4. الزوار (أولياء الأمور)
- الحلقات المتاحة للتسجيل
- مواعيد الجلسات
- عدد الحلقات الإجمالي
- عدد جلسات اليوم

## معالجة الأخطاء والتحميل

- يعرض المكون حالة تحميل (loading state) أثناء جلب البيانات
- يعرض رسائل خطأ واضحة في حالة فشل جلب البيانات
- يستمر في عرض الإحصائيات المتاحة حتى في حالة فشل بعض الاستعلامات

## التخصيص

يمكن تخصيص مظهر البطاقات الإحصائية باستخدام خصائص `color` و `textColor` في مكون `StatCard`.

## ملاحظات للمطورين

- تم تصميم المكون ليكون مرنًا ويعمل حتى عندما تكون بعض جداول قاعدة البيانات غير متوفرة
- يتم التعامل مع الأخطاء في كل استعلام بشكل منفصل لتجنب فشل المكون بالكامل
- يمكن إضافة المزيد من الإحصائيات المخصصة حسب احتياجات كل دور مستخدم
